apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd-image-updater.argoproj.io/image-list: flask=docker.io/sergklm1/flask-sample:latest
    argocd-image-updater.argoproj.io/flask.update-strategy: digest
    argocd-image-updater.argoproj.io/flask.helm.image-name: image.repository
    argocd-image-updater.argoproj.io/flask.helm.image-tag: image.tag
  name: flask-sample
  namespace: argocd
spec:
  destination:
    namespace: default
    server: https://kubernetes.default.svc
  project: default
  source:
    path: helm/charts/flask-sample
    repoURL: https://github.com/sergklm98/argocd-iu
    targetRevision: HEAD
    helm:
      releaseName: flask-sample
      parameters:
        - name: containerPort
          value: '5000'
        - name: image.repository
          value: docker.io/sergklm1/flask-sample
        - name: image.tag
          value: latest
        - name: image.pullPolicy
          value: Always
  # syncPolicy:
  #   automated:
  #     prune: true